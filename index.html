<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<title>Herbal&Heaven | Premium Organic Rituals</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>

<style>
/* ---------- 1. Variables & Reset ---------- */
:root {
  --primary: #2d4a22;
  --primary-hover: #1e3316;
  --secondary: #f4e9d5;
  --accent: #c5a059;
  --text-dark: #2c2c2c;
  --white: #ffffff;
  --danger: #e74c3c;
  --success: #27ae60;
  --font-heading: 'Playfair Display', serif;
  --font-body: 'Lato', sans-serif;
  --shadow: 0 10px 30px rgba(0,0,0,0.08);
  --radius: 8px;
  --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
}

* { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

html { scroll-behavior: smooth; }
body {
  font-family: var(--font-body);
  background-color: #fdfbf7;
  color: var(--text-dark);
  line-height: 1.6;
  overflow-x: hidden;
  padding-bottom: 70px;
}

h1, h2, h3, h4 { font-family: var(--font-heading); color: var(--primary); }
a { text-decoration: none; color: inherit; transition: var(--transition); }
button { cursor: pointer; border: none; outline: none; font-family: var(--font-body); }
img { max-width: 100%; display: block; }
input, textarea { font-family: var(--font-body); }

/* ---------- 2. UI Components ---------- */
.container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }

.btn {
  display: inline-flex; align-items: center; justify-content: center; gap: 8px;
  padding: 12px 24px;
  border-radius: 50px;
  font-weight: 700;
  letter-spacing: 0.5px;
  transition: var(--transition);
  text-transform: uppercase;
  font-size: 12px;
}

.btn-primary {
  background: var(--primary); color: var(--white);
  box-shadow: 0 4px 15px rgba(45, 74, 34, 0.3);
}
.btn-primary:hover { background: var(--primary-hover); transform: translateY(-2px); }

.btn-secondary {
  background: transparent; color: var(--primary); border: 1px solid var(--primary);
}
.btn-secondary:hover { background: var(--primary); color: var(--white); }

.btn-icon {
    width: 35px; height: 35px; border-radius: 50%; display: inline-flex; 
    align-items: center; justify-content: center; color: white; margin-left: 5px;
}

.badge {
  position: absolute; top: 15px; left: 15px;
  background: var(--accent); color: white;
  padding: 4px 12px; font-size: 11px;
  border-radius: 50px; text-transform: uppercase; letter-spacing: 1px;
  z-index: 2;
}

/* ---------- 3. Header ---------- */
header {
  position: sticky; top: 0; z-index: 100;
  background: rgba(253, 251, 247, 0.95);
  backdrop-filter: blur(10px);
  border-bottom: 1px solid rgba(0,0,0,0.05);
  padding: 10px 0;
}

.nav-wrapper { display: flex; justify-content: space-between; align-items: center; }

.logo {
  display: flex; align-items: center; gap: 10px;
  font-family: var(--font-heading); font-size: 20px; font-weight: 700; color: var(--primary);
}
.logo img { 
    height: 50px; width: 50px; border-radius: 50%; object-fit: cover;
    animation: rotateLogo 20s linear infinite;
}

@keyframes rotateLogo { 100% { transform: rotate(360deg); } }

.nav-menu { display: flex; gap: 30px; }
.nav-menu a { font-size: 14px; font-weight: 700; color: var(--text-dark); position: relative; }
.nav-menu a::after {
  content: ''; position: absolute; bottom: -5px; left: 0; width: 0; height: 2px;
  background: var(--accent); transition: var(--transition);
}
.nav-menu a:hover::after { width: 100%; }

.nav-icons { display: flex; align-items: center; gap: 20px; }
.cart-icon-wrap { position: relative; cursor: pointer; font-size: 20px; padding: 5px; } 
.cart-count {
  position: absolute; top: -5px; right: -5px;
  background: var(--danger); color: white;
  width: 18px; height: 18px; border-radius: 50%;
  font-size: 10px; display: flex; align-items: center; justify-content: center;
}

.mobile-toggle { display: none; font-size: 24px; cursor: pointer; color: var(--primary); padding: 5px; }

.top-contact {
  background:#345b2a; color:#fff; text-align:center;
  padding:6px 10px; font-size:0.8rem; font-weight: 600;
}

/* ---------- 4. Hero Section ---------- */
.hero {
  position: relative; height: 70vh; min-height: 500px;
  background: url('https://images.unsplash.com/photo-1540555700478-4be289fbecef?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80') center/cover no-repeat;
  display: flex; align-items: center; margin-bottom: 60px;
}
.hero::before {
  content: ''; position: absolute; inset: 0;
  background: linear-gradient(to right, rgba(0,0,0,0.5), rgba(0,0,0,0.1));
}
.hero-content {
  position: relative; z-index: 2; color: white;
  max-width: 600px; padding-left: 5%;
  animation: slideUp 0.8s ease-out;
}
.hero h1 { font-size: 42px; line-height: 1.2; margin-bottom: 20px; color: white; }
.hero p { font-size: 16px; margin-bottom: 30px; opacity: 0.95; }

@keyframes slideUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }

/* ---------- 5. Products & Filters ---------- */
.section-title { text-align: center; margin-bottom: 40px; }
.section-title h2 { font-size: 32px; margin-bottom: 10px; }

.filter-container {
  display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin-bottom: 30px; align-items: center;
}
.search-box { position: relative; width: 100%; max-width: 300px; margin: 0 auto 15px auto; }
.search-box input {
  width: 100%; padding: 12px 20px; padding-right: 40px; border-radius: 50px;
  border: 1px solid #ddd; outline: none; font-size: 14px;
}
.search-box i { position: absolute; right: 15px; top: 50%; transform: translateY(-50%); color: #aaa; }
.filter-btn {
  padding: 8px 18px; border-radius: 50px; border: 1px solid #ddd; background: white;
  cursor: pointer; transition: var(--transition); font-size: 13px; font-weight: 600;
}
.filter-btn.active, .filter-btn:hover { background: var(--primary); color: white; border-color: var(--primary); }

.products-grid {
  display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
  gap: 25px; padding-bottom: 60px;
}

.product-card {
  background: white; border-radius: var(--radius); overflow: hidden;
  box-shadow: var(--shadow); transition: var(--transition); border: 1px solid #f0f0f0;
  will-change: transform;
}
.product-card:hover { transform: translateY(-5px); box-shadow: 0 15px 30px rgba(0,0,0,0.1); }

.product-img { height: 260px; overflow: hidden; position: relative; background: #f9f9f9; }
.product-img img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.5s ease; }
.product-card:hover .product-img img { transform: scale(1.05); }

.product-info { padding: 15px; text-align: center; }
.product-title { font-size: 18px; margin: 8px 0; color: var(--text-dark); }
.product-price { font-weight: 700; color: var(--primary); font-size: 16px; margin-bottom: 15px; }
.card-btns { display: flex; gap: 8px; justify-content: center; }

/* ---------- 6. Reviews Section ---------- */
.testimonials { background: var(--secondary); padding: 60px 0; margin-bottom: 60px; }
.reviews-header { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 30px; flex-wrap: wrap; gap: 15px; }
.testimonial-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
.testimonial-card { background: white; padding: 25px; border-radius: var(--radius); box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
.testimonial-stars { color: var(--accent); margin-bottom: 10px; font-size: 14px; }
.testimonial-text { font-style: italic; color: #555; margin-bottom: 15px; font-size: 14px; }
.testimonial-author { font-weight: 700; color: var(--primary); font-size: 13px; text-align: right; }

/* ---------- 7. Modals (Universal) ---------- */
.overlay {
  position: fixed; inset: 0; background: rgba(0,0,0,0.6);
  z-index: 999; opacity: 0; visibility: hidden; transition: var(--transition);
  backdrop-filter: blur(3px);
}
.overlay.active { opacity: 1; visibility: visible; }

.modal {
  position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0.95);
  width: 90%; max-width: 500px; background: white;
  z-index: 1000; border-radius: 12px; padding: 25px;
  opacity: 0; visibility: hidden; transition: var(--transition);
  box-shadow: 0 25px 50px rgba(0,0,0,0.25);
  max-height: 90vh; overflow-y: auto;
}
.modal.active { opacity: 1; visibility: visible; transform: translate(-50%, -50%) scale(1); }

.form-group { margin-bottom: 15px; }
.form-group label { display: block; margin-bottom: 6px; font-size: 13px; font-weight: 700; }
.form-group input, .form-group textarea, .form-group select {
  width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;
}

.star-rating { direction: rtl; display: inline-flex; font-size: 24px; cursor: pointer; }
.star-rating input { display: none; }
.star-rating label { color: #ddd; margin: 0 2px; transition: color 0.2s; }
.star-rating input:checked ~ label, .star-rating label:hover, .star-rating label:hover ~ label { color: var(--accent); }

/* ---------- 8. Cart Drawer ---------- */
.cart-drawer {
  position: fixed; top: 0; right: -100%; width: 100%; max-width: 400px; height: 100%;
  background: white; z-index: 1001; transition: var(--transition);
  display: flex; flex-direction: column; box-shadow: -5px 0 25px rgba(0,0,0,0.1);
}
.cart-drawer.active { right: 0; }
.cart-header { padding: 15px 20px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; }
.cart-body { flex: 1; overflow-y: auto; padding: 20px; }
.cart-item { display: flex; gap: 12px; margin-bottom: 15px; align-items: center; background: #fff; }
.cart-item img { width: 50px; height: 50px; border-radius: 6px; object-fit: cover; }
.cart-controls { display: flex; align-items: center; gap: 10px; margin-top: 5px; }
.qty-btn { width: 25px; height: 25px; border-radius: 50%; background: #f0f0f0; display: flex; align-items: center; justify-content: center; }

/* ---------- 9. Social Media Bar ---------- */
.social-bar {
  position: fixed; bottom: 0; left: 0; width: 100%;
  background: white; border-top: 1px solid #eee;
  display: flex; justify-content: space-around; align-items: center;
  padding: 10px 0; z-index: 900;
  box-shadow: 0 -5px 15px rgba(0,0,0,0.05);
}
.social-link {
  display: flex; flex-direction: column; align-items: center;
  font-size: 12px; color: var(--text-dark); gap: 4px;
}
.social-link i { font-size: 20px; transition: transform 0.2s; }
.social-link:hover i { transform: translateY(-3px); }

.fa-whatsapp { color: #25d366; }
.fa-instagram { color: #C13584; }
.fa-facebook { color: #1877F2; }

/* Toast */
.toast {
  position: fixed; bottom: 80px; left: 50%; transform: translateX(-50%) translateY(20px);
  background: rgba(30,30,30,0.9); color: white; padding: 10px 20px; border-radius: 30px;
  font-size: 14px; opacity: 0; transition: 0.3s; pointer-events: none; z-index: 2000;
  display: flex; align-items: center; gap: 8px; width: max-content;
}
.toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }

/* Responsive Media Queries */
@media (max-width: 768px) {
  .mobile-toggle { display: block; }
  .nav-menu {
    position: fixed; top: 0; left: -100%; width: 280px; height: 100vh;
    background: white; flex-direction: column; padding: 60px 20px;
    box-shadow: 5px 0 15px rgba(0,0,0,0.1); z-index: 1001;
    transition: left 0.3s ease;
  }
  .nav-menu.active { left: 0; }
  .nav-menu a { font-size: 16px; padding: 15px 0; border-bottom: 1px solid #f5f5f5; }
  .hero { height: 60vh; }
  .hero h1 { font-size: 32px; }
  .cart-drawer { width: 85%; }
  .filter-container { flex-direction: column; align-items: stretch; }
  .search-box { width: 100%; max-width: none; }
  .modal { width: 95%; padding: 20px; }
  .payment-buttons { flex-direction: column; }
}
</style>
</head>
<body>

<div class="top-contact">
  Free Shipping on orders above â‚¹499 | Support: +91-9595641664
</div>

<header>
  <div class="container nav-wrapper">
    <div class="mobile-toggle" onclick="toggleMenu()">
      <i class="fa-solid fa-bars"></i>
    </div>

    <a href="#" class="logo">
      <img src="herb.jpg" alt="Logo" loading="lazy">
      <span>Herbal&Heaven</span>
    </a>
    
    <nav class="nav-menu" id="mainMenu">
      <button onclick="toggleMenu()" style="position: absolute; top: 20px; right: 20px; font-size: 20px; background:none;"><i class="fa-solid fa-times"></i></button>
      <a href="#home" onclick="toggleMenu()">Home</a>
      <a href="#products" onclick="toggleMenu()">Shop</a>
      <a href="#reviews" onclick="toggleMenu()">Reviews</a>
      <a href="#" onclick="openAdminLogin(); toggleMenu()">Admin</a>
    </nav>
    
    <div class="nav-icons">
      <div class="cart-icon-wrap" onclick="toggleCart()">
        <i class="fa-solid fa-shopping-bag"></i>
        <span class="cart-count" id="cartCount">0</span>
      </div>
    </div>
  </div>
</header>

<div class="overlay" id="menuOverlay" onclick="toggleMenu()"></div>

<section id="home" class="hero">
  <div class="container hero-content">
    <span style="color:var(--accent); font-weight:700; letter-spacing:1px; margin-bottom:10px; display:block;">100% ORGANIC</span>
    <h1>Nature's Purest <br>Secret for You</h1>
    <p>Handcrafted, chemical-free skincare rituals designed for your inner glow.</p>
    <button class="btn btn-primary" onclick="document.getElementById('products').scrollIntoView()">Shop Now</button>
  </div>
</section>

<section id="products" class="container">
  <div class="section-title">
    <h2>Curated Rituals</h2>
  </div>

  <div class="filter-container">
    <div class="search-box">
      <input type="text" id="search" placeholder="Search soaps, oils..." onkeyup="filterProducts()">
      <i class="fa-solid fa-search"></i>
    </div>
    <div style="display:flex; gap:10px; overflow-x:auto; padding-bottom:5px; width:100%; justify-content:center;">
      <button class="filter-btn active" onclick="filterCat('all', this)">All</button>
      <button class="filter-btn" onclick="filterCat('Face', this)">Face</button>
      <button class="filter-btn" onclick="filterCat('Body', this)">Body</button>
      <button class="filter-btn" onclick="filterCat('Glow', this)">Glow</button>
    </div>
  </div>

  <div class="products-grid" id="productsGrid">
    </div>
</section>

<section id="reviews" class="testimonials">
  <div class="container">
    <div class="reviews-header">
      <div>
        <h2>Customer Love</h2>
        <p>See what our community is saying</p>
      </div>
      <button class="btn btn-primary" onclick="openReviewModal()"><i class="fa-solid fa-pen"></i> Write a Review</button>
    </div>
    <div class="testimonial-grid" id="reviewGrid">
      </div>
  </div>
</section>

<footer style="background: #222; color: #fff; padding: 40px 0; margin-bottom: 60px;">
  <div class="container" style="text-align: center;">
    <h3 style="color: white; margin-bottom: 10px;">Herbal&Heaven</h3>
    <p style="color: #888; font-size: 13px;">Nature's Pure Essence. Made with Love.</p>
  </div>
</footer>

<div class="social-bar">
    <a href="https://wa.me/919595641664" target="_blank" class="social-link">
        <i class="fa-brands fa-whatsapp"></i>
        <span>WhatsApp</span>
    </a>
    <a href="https://instagram.com/aose_clothing" target="_blank" class="social-link">
        <i class="fa-brands fa-instagram"></i>
        <span>Instagram</span>
    </a>
    <a href="https://facebook.com" target="_blank" class="social-link">
        <i class="fa-brands fa-facebook"></i>
        <span>Facebook</span>
    </a>
</div>

<div class="toast" id="toast">Item added to cart</div>

<div class="overlay" id="cartOverlay" onclick="toggleCart()"></div>
<div class="cart-drawer" id="cartDrawer">
  <div class="cart-header">
    <h3>Your Bag</h3>
    <button onclick="toggleCart()" style="background:none; font-size:18px;"><i class="fa-solid fa-times"></i></button>
  </div>
  <div class="cart-body" id="cartItems"></div>
  <div class="cart-header" style="border-top:1px solid #eee; border-bottom:none; flex-direction:column; gap:15px; background:#fdfbf7;">
    <div style="display:flex; justify-content:space-between; width:100%; font-weight:700;">
      <span>Total</span>
      <span id="cartTotal">â‚¹0</span>
    </div>
    <button class="btn btn-primary" style="width:100%;" onclick="openCheckout()">Checkout</button>
  </div>
</div>

<div class="overlay" id="leadOverlay"></div>
<div class="modal" id="leadModal">
  <div style="text-align:center;">
    <h3 style="margin-bottom:10px;">Welcome to the Family! ðŸŒ¿</h3>
    <p style="font-size:14px; color:#666; margin-bottom:20px;">Join our community to unlock exclusive offers and track your orders.</p>
    <form onsubmit="submitLead(event)">
      <div class="form-group">
        <input type="text" id="leadName" placeholder="Your Name" required>
      </div>
      <div class="form-group">
        <input type="email" id="leadEmail" placeholder="Your Email Address" required>
      </div>
      <div class="form-group">
        <input type="tel" id="leadPhone" placeholder="Phone Number" required>
      </div>
      <button type="submit" class="btn btn-primary" style="width:100%;">Continue Shopping</button>
      <button type="button" onclick="closeLeadModal()" style="margin-top:10px; font-size:12px; color:#999; background:none; text-decoration:underline;">I'll do this later</button>
    </form>
  </div>
</div>

<div class="modal" id="reviewModal">
  <button onclick="closeReviewModal()" style="position: absolute; right: 15px; top: 15px; font-size: 18px; background:none;"><i class="fa-solid fa-times"></i></button>
  <h3 style="margin-bottom:15px;">Write a Review</h3>
  <form onsubmit="submitReview(event)">
    <div class="form-group">
      <input type="text" id="revName" placeholder="Your Name" required>
    </div>
    <div class="form-group" style="text-align:center; margin: 15px 0;">
      <label>Rate Product</label>
      <div class="star-rating">
        <input type="radio" id="s5" name="rating" value="5" required><label for="s5">â˜…</label>
        <input type="radio" id="s4" name="rating" value="4"><label for="s4">â˜…</label>
        <input type="radio" id="s3" name="rating" value="3"><label for="s3">â˜…</label>
        <input type="radio" id="s2" name="rating" value="2"><label for="s2">â˜…</label>
        <input type="radio" id="s1" name="rating" value="1"><label for="s1">â˜…</label>
      </div>
    </div>
    <div class="form-group">
      <textarea id="revText" rows="3" placeholder="Share your experience..." required></textarea>
    </div>
    <button type="submit" class="btn btn-primary" style="width:100%;">Post Review</button>
  </form>
</div>

<div class="modal" id="checkoutModal">
  <button onclick="closeCheckout()" style="position: absolute; right: 15px; top: 15px; background:none;"><i class="fa-solid fa-times"></i></button>
  
  <div id="step1">
    <h3>Shipping Info</h3>
    <form onsubmit="goToPayment(event)">
      <div class="form-group"><input id="cName" type="text" placeholder="Full Name" required></div>
      <div class="form-group">
          <input id="cEmail" type="email" placeholder="Email Address (For Bill)" required>
      </div>
      <div class="form-group"><input id="cPhone" type="tel" placeholder="Phone" required></div>
      <div class="form-group"><textarea id="cAddr" rows="2" placeholder="Full Address" required></textarea></div>
      <button type="submit" class="btn btn-primary" style="width:100%;">Proceed to Pay</button>
    </form>
  </div>

  <div id="step2" style="display:none; text-align:center;">
    <h3>Payment</h3>
    <p style="margin-bottom:15px;">Total: <strong id="payAmount"></strong></p>
    <div style="display:grid; gap:10px; margin-bottom:20px;">
      <button class="btn" style="background:#4285F4; color:white;" onclick="pay('Google Pay')"><i class="fa-brands fa-google"></i> Google Pay</button>
      <button class="btn" style="background:#5F259F; color:white;" onclick="pay('PhonePe')">PhonePe</button>
      <button class="btn" style="background:#00B9F1; color:white;" onclick="pay('Paytm')">Paytm</button>
    </div>
    <p style="font-size:12px; color:#666;">OR Scan QR Code</p>
    <img id="qrImg" style="width:150px; margin:10px auto; border:1px solid #eee;">
    <div style="font-family:monospace; background:#f0f0f0; padding:5px; font-size:12px; margin-bottom:15px;" id="showUpi"></div>
    <button class="btn btn-success" style="background:var(--success); color:white; width:100%;" onclick="confirmOrder()">I have Paid</button>
  </div>
  
  <div id="step3" style="display:none; text-align:center;">
    <i class="fa-solid fa-circle-check" style="color:var(--success); font-size:50px; margin-bottom:15px;"></i>
    <h3>Order Placed!</h3>
    <p style="margin-bottom:20px;">We have sent your order details to Herbal&Heaven via WhatsApp.</p>
    <button class="btn btn-secondary" onclick="closeCheckout(); location.reload();" style="margin-top:20px;">Close</button>
  </div>
</div>

<div class="modal" id="adminModal">
  <button onclick="document.getElementById('adminModal').classList.remove('active'); document.querySelector('.overlay').classList.remove('active');" style="position: absolute; right: 15px; top: 15px; background:none;"><i class="fa-solid fa-times"></i></button>
  <div id="adminLogin">
    <h3>Admin Login</h3>
    <input type="password" id="admPass" placeholder="Password" style="width:100%; padding:10px; margin:15px 0;">
    <button class="btn btn-primary" onclick="checkAdmin()">Login</button>
  </div>
  <div id="adminDash" style="display:none;">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
      <h3>Dashboard</h3>
      <button class="btn btn-primary" onclick="refreshData()"><i class="fa-solid fa-rotate-right"></i></button>
    </div>
    <div style="display:flex; gap:10px; margin-bottom:15px;">
        <button class="btn btn-secondary" onclick="exportOrders()">Orders .xlsx</button>
        <button class="btn btn-secondary" onclick="exportCustomers()">Customers .xlsx</button>
    </div>
    <div style="overflow-x:auto; max-height: 400px;">
        <table style="width:100%; font-size:12px; text-align:left; border-collapse:collapse;" id="orderTable">
            <thead><tr style="background:#f5f5f5;"><th>ID/Name</th><th>Items</th><th>Notify</th></tr></thead>
            <tbody id="orderBody"></tbody>
        </table>
    </div>
    
    <div style="margin-top: 30px; padding-top: 20px; border-top: 2px dashed #eee; text-align: center;">
        <button class="btn" style="background: var(--danger); color: white;" onclick="resetDatabase()">
            <i class="fa-solid fa-trash"></i> Reset Database
        </button>
    </div>
  </div>
</div>

<script>
// --- CONFIG ---
const UPI_ID = "damareomkar96@oksbi";
const ADMIN_PASS = "omti96";
const OWNER_PHONE = "919595641664"; // Your Phone
const OWNER_EMAIL = "damareomkar96@gmail.com"; // Your Email
const SECRET_CODE = "DELETE99"; // Code to delete database

// --- DATA ---
const products = [
  { id: 1, name: "Neem Soap", cat: "Face", price: 150, img: "proo.jpg" },
  { id: 2, name: "Papaya Soap", cat: "Glow", price: 150, img: "pro.jpg" },
  { id: 3, name: "Tulsi Soap", cat: "Body", price: 150, img: "pro1.jpg" },
  { id: 4, name: "Aloe Vera", cat: "Face", price: 150, img: "pro4.jpg" },
  { id: 5, name: "Detan Bar", cat: "Glow", price: 150, img: "pro5.jpg" },
  { id: 6, name: "Rose Soap", cat: "Body", price: 150, img: "pro3.jpg" },
  { id: 7, name: "Charcoal", cat: "Face", price: 150, img: "pro7.jpg" },
  { id: 8, name: "Multani", cat: "Glow", price: 150, img: "pro8.jpg" }
];

// Initial Reviews
let reviews = JSON.parse(localStorage.getItem('hh_reviews') || JSON.stringify([
    {name: "Priya S.", rating: 5, text: "The Neem soap saved my skin! Acne is gone."},
    {name: "Rahul K.", rating: 4, text: "Great smell, fast delivery."},
    {name: "Anjali M.", rating: 5, text: "Packaging is eco-friendly. Love it!"}
]));

let cart = [];
let orders = JSON.parse(localStorage.getItem('hh_orders') || '[]');
let customers = JSON.parse(localStorage.getItem('hh_customers') || '[]');
let payMethod = '';

// --- INIT ---
window.onload = () => {
    renderProducts(products);
    renderReviews();
    checkLeadGen();
};

// --- LEAD GEN LOGIC ---
function checkLeadGen() {
    if (!localStorage.getItem('hh_user_signed')) {
        setTimeout(() => {
            document.getElementById('leadModal').classList.add('active');
            document.getElementById('leadOverlay').classList.add('active');
        }, 2000);
    }
}

function closeLeadModal() {
    document.getElementById('leadModal').classList.remove('active');
    document.getElementById('leadOverlay').classList.remove('active');
    localStorage.setItem('hh_user_signed', 'skipped'); 
}

function submitLead(e) {
    e.preventDefault();
    const data = {
        name: document.getElementById('leadName').value,
        email: document.getElementById('leadEmail').value,
        phone: document.getElementById('leadPhone').value,
        date: new Date().toLocaleDateString()
    };
    customers.push(data);
    localStorage.setItem('hh_customers', JSON.stringify(customers));
    localStorage.setItem('hh_user_signed', 'true');
    
    // Auto-fill checkout details
    localStorage.setItem('hh_saved_name', data.name);
    localStorage.setItem('hh_saved_email', data.email);
    localStorage.setItem('hh_saved_phone', data.phone);
    
    closeLeadModal();
    showToast(`Welcome to the family, ${data.name}!`);
}

// --- PRODUCT & FILTER ---
function renderProducts(list) {
    const grid = document.getElementById('productsGrid');
    grid.innerHTML = list.map(p => `
        <div class="product-card">
            <div class="badge">Pure</div>
            <div class="product-img"><img src="${p.img}" alt="${p.name}" loading="lazy"></div>
            <div class="product-info">
                <h3 class="product-title">${p.name}</h3>
                <div class="product-price">â‚¹${p.price}</div>
                <div class="card-btns">
                    <button class="btn btn-primary" onclick="addToCart(${p.id})">Add</button>
                    <button class="btn btn-secondary" onclick="buyNow(${p.id})">Buy</button>
                </div>
            </div>
        </div>
    `).join('');
}

function filterProducts() {
    const q = document.getElementById('search').value.toLowerCase();
    const filtered = products.filter(p => p.name.toLowerCase().includes(q));
    renderProducts(filtered);
}

function filterCat(cat, btn) {
    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    const list = cat === 'all' ? products : products.filter(p => p.cat.includes(cat));
    renderProducts(list);
}

// --- CART ---
function addToCart(id) {
    const p = products.find(x => x.id === id);
    const exist = cart.find(x => x.id === id);
    if(exist) exist.qty++; else cart.push({...p, qty:1});
    updateCart();
    showToast("Added to Bag");
}

function updateCart() {
    const count = cart.reduce((a,b) => a+b.qty, 0);
    const total = cart.reduce((a,b) => a+(b.price*b.qty), 0);
    document.getElementById('cartCount').innerText = count;
    document.getElementById('cartTotal').innerText = 'â‚¹' + total;
    
    document.getElementById('cartItems').innerHTML = cart.length ? cart.map(i => `
        <div class="cart-item">
            <img src="${i.img}">
            <div style="flex:1;">
                <div style="font-weight:700; font-size:14px;">${i.name}</div>
                <div style="font-size:12px; color:#666;">â‚¹${i.price}</div>
                <div class="cart-controls">
                    <button class="qty-btn" onclick="modQty(${i.id}, -1)">-</button>
                    <span>${i.qty}</span>
                    <button class="qty-btn" onclick="modQty(${i.id}, 1)">+</button>
                </div>
            </div>
        </div>
    `).join('') : '<p style="text-align:center; color:#999;">Empty Bag</p>';
}

function modQty(id, n) {
    const item = cart.find(x => x.id === id);
    item.qty += n;
    if(item.qty <= 0) cart = cart.filter(x => x.id !== id);
    updateCart();
}

function toggleCart() {
    const drawer = document.getElementById('cartDrawer');
    const over = document.getElementById('cartOverlay');
    if(drawer.classList.contains('active')) {
        drawer.classList.remove('active'); over.classList.remove('active');
    } else {
        drawer.classList.add('active'); over.classList.add('active');
        document.getElementById('menuOverlay').classList.remove('active');
    }
}

function buyNow(id) {
    cart = []; addToCart(id); toggleCart(); openCheckout();
}

// --- REVIEW SYSTEM ---
function openReviewModal() {
    document.getElementById('reviewModal').classList.add('active');
    document.querySelector('.overlay').classList.add('active');
}
function closeReviewModal() {
    document.getElementById('reviewModal').classList.remove('active');
    document.querySelector('.overlay').classList.remove('active');
}
function submitReview(e) {
    e.preventDefault();
    const name = document.getElementById('revName').value;
    const text = document.getElementById('revText').value;
    const rating = document.querySelector('input[name="rating"]:checked').value;
    
    const newRev = {name, text, rating: parseInt(rating)};
    reviews.unshift(newRev); // Add to top
    localStorage.setItem('hh_reviews', JSON.stringify(reviews));
    
    renderReviews();
    closeReviewModal();
    showToast("Review Posted! Thank you.");
    e.target.reset();
}

function renderReviews() {
    const container = document.getElementById('reviewGrid');
    container.innerHTML = reviews.map(r => `
        <div class="testimonial-card">
            <div class="testimonial-stars">${'â˜…'.repeat(r.rating)}${'â˜†'.repeat(5-r.rating)}</div>
            <p class="testimonial-text">"${r.text}"</p>
            <div class="testimonial-author">- ${r.name}</div>
        </div>
    `).join('');
}

// --- CHECKOUT ---
function openCheckout() {
    if(!cart.length) return showToast("Cart is empty");
    toggleCart(); 
    const modal = document.getElementById('checkoutModal');
    const over = document.querySelector('.overlay');
    modal.classList.add('active'); over.classList.add('active');
    
    // Auto-fill
    if(localStorage.getItem('hh_saved_name')) {
        document.getElementById('cName').value = localStorage.getItem('hh_saved_name');
        document.getElementById('cEmail').value = localStorage.getItem('hh_saved_email');
        document.getElementById('cPhone').value = localStorage.getItem('hh_saved_phone');
    }
    
    document.getElementById('step1').style.display = 'block';
    document.getElementById('step2').style.display = 'none';
    document.getElementById('step3').style.display = 'none';
}

function closeCheckout() {
    document.getElementById('checkoutModal').classList.remove('active');
    document.querySelector('.overlay').classList.remove('active');
}

function goToPayment(e) {
    e.preventDefault();
    document.getElementById('step1').style.display = 'none';
    document.getElementById('step2').style.display = 'block';
    
    const total = cart.reduce((a,b) => a+(b.price*b.qty), 0);
    document.getElementById('payAmount').innerText = 'â‚¹' + total;
    document.getElementById('showUpi').innerText = UPI_ID;
    
    // Generate QR
    const url = `upi://pay?pa=${UPI_ID}&pn=HerbalHeaven&am=${total}&cu=INR`;
    document.getElementById('qrImg').src = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(url)}`;
}

function pay(method) {
    payMethod = method;
    const total = cart.reduce((a,b) => a+(b.price*b.qty), 0);
    let link = "";
    if(method === 'Google Pay') link = `tez://upi/pay?pa=${UPI_ID}&pn=Herbal&am=${total}&cu=INR`;
    if(method === 'PhonePe') link = `phonepe://upi/pay?pa=${UPI_ID}&pn=Herbal&am=${total}&cu=INR`;
    if(method === 'Paytm') link = `paytmmp://upi/pay?pa=${UPI_ID}&pn=Herbal&am=${total}&cu=INR`;
    
    window.location.href = link;
}

function confirmOrder() {
    const custName = document.getElementById('cName').value;
    const custEmail = document.getElementById('cEmail').value;
    const custPhone = document.getElementById('cPhone').value;
    const custAddr = document.getElementById('cAddr').value;
    const total = cart.reduce((a,b) => a+(b.price*b.qty), 0);
    const itemList = cart.map(i=>`${i.name} (x${i.qty})`).join(', ');

    // 1. Save Order locally
    const order = {
        id: 'ORD' + Math.floor(Math.random()*10000),
        date: new Date().toLocaleString(),
        customer: custName,
        email: custEmail,
        phone: custPhone,
        address: custAddr,
        items: cart,
        total: total,
        method: payMethod || 'QR Scan'
    };
    orders.push(order);
    localStorage.setItem('hh_orders', JSON.stringify(orders));

    // 2. Alert Owner via WhatsApp (Simulates the Customer sending the order)
    const msg = `New Order!%0AID: ${order.id}%0AName: ${custName}%0AItems: ${itemList}%0ATotal: â‚¹${total}%0AAddress: ${custAddr}`;
    const waUrl = `https://wa.me/${OWNER_PHONE}?text=${msg}`;
    window.open(waUrl, '_blank');

    // 3. Update UI
    document.getElementById('step2').style.display = 'none';
    document.getElementById('step3').style.display = 'block';
    
    cart = []; updateCart();
}

// --- ADMIN & NOTIFICATIONS ---
function toggleMenu() {
    document.getElementById('mainMenu').classList.toggle('active');
    document.getElementById('menuOverlay').classList.toggle('active');
}

function showToast(msg) {
    const t = document.getElementById('toast');
    t.innerText = msg; t.classList.add('show');
    setTimeout(() => t.classList.remove('show'), 3000);
}

function openAdminLogin() {
    const modal = document.getElementById('adminModal');
    const over = document.querySelector('.overlay');
    modal.classList.add('active'); over.classList.add('active');
    document.getElementById('adminLogin').style.display = 'block';
    document.getElementById('adminDash').style.display = 'none';
}

function checkAdmin() {
    if(document.getElementById('admPass').value === ADMIN_PASS) {
        document.getElementById('adminLogin').style.display = 'none';
        document.getElementById('adminDash').style.display = 'block';
        refreshData();
    } else alert("Wrong Password");
}

function refreshData() {
    const tbody = document.getElementById('orderBody');
    tbody.innerHTML = orders.map(o => `
        <tr style="border-bottom:1px solid #eee;">
            <td style="padding:8px;">
                <strong>${o.id}</strong><br>${o.customer}<br>
                <small>${o.phone}</small>
            </td>
            <td style="padding:8px;">
                ${o.items.map(i=>`${i.name} (${i.qty})`).join('<br>')}
                <br><strong>â‚¹${o.total}</strong>
            </td>
            <td style="padding:8px; white-space:nowrap;">
                <button class="btn-icon" style="background:#25d366" onclick="notifyWA('${o.phone}', '${o.customer}', '${o.id}', '${o.total}')"><i class="fa-brands fa-whatsapp"></i></button>
                <button class="btn-icon" style="background:#DB4437" onclick="notifyEmail('${o.email}', '${o.customer}', '${o.id}', '${o.total}')"><i class="fa-solid fa-envelope"></i></button>
            </td>
        </tr>
    `).join('');
}

// "Manual Automation" - One click triggers
function notifyWA(phone, name, id, total) {
    const msg = `Hi ${name}, Your order ${id} of â‚¹${total} is successfully confirmed! We will ship it shortly. - Herbal&Heaven`;
    window.open(`https://wa.me/${phone}?text=${encodeURIComponent(msg)}`, '_blank');
}

function notifyEmail(email, name, id, total) {
    const subject = `Order Confirmed: ${id}`;
    const body = `Hi ${name},\n\nThank you for ordering from Herbal&Heaven!\nYour order ${id} amounting to â‚¹${total} is confirmed.\n\nWe will ship your items soon.\n\nRegards,\nOmkar`;
    window.open(`mailto:${email}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`);
}

// Data Management
function resetDatabase() {
    const code = prompt("Enter Secret Code to DELETE ALL DATA:");
    if(code === SECRET_CODE) {
        if(confirm("Are you sure? This cannot be undone.")) {
            localStorage.removeItem('hh_orders');
            localStorage.removeItem('hh_customers');
            orders = [];
            customers = [];
            refreshData();
            alert("Database Wiped.");
        }
    } else {
        alert("Incorrect Code.");
    }
}

function exportOrders() {
    const ws = XLSX.utils.json_to_sheet(orders.map(o => ({
        ID: o.id, Date: o.date, Name: o.customer, Phone: o.phone, 
        Addr: o.address, Total: o.total, Method: o.method,
        Items: o.items.map(i=>`${i.name}(${i.qty})`).join(', ')
    })));
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "Orders");
    XLSX.writeFile(wb, "Herbal_Orders.xlsx");
}

function exportCustomers() {
    if(!customers.length) return alert("No customer data recorded yet.");
    const ws = XLSX.utils.json_to_sheet(customers);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "Customers");
    XLSX.writeFile(wb, "Herbal_Customers_Leads.xlsx");
}

</script>
</body>
</html>
